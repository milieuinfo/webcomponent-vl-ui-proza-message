import{VlElement,define}from"/node_modules/vl-ui-core/vl-core.js";import"/node_modules/vl-ui-button/vl-button.js";import"/node_modules/vl-ui-icon/vl-icon.js";export class VlProzaMessage extends(VlElement(HTMLElement)){static get _observedAttributes(){return["data-vl-domain","data-vl-code"]}constructor(){super("\n            <style>\n                @import '/node_modules/vl-ui-button/style.css';\n                @import '/node_modules/vl-ui-icon/style.css';\n            </style>\n            <div>\n                <span id=\"content\"></span>\n            </div>\n        ")}connectedCallback(){this.__processToegelatenOperaties()}get _contentElement(){return this._element.querySelector("#content")}_getEditButtonTemplate(){return this._template('\n            <button is="vl-button-link" type="button">\n                <span is="vl-icon" icon="edit"></span>\n            </button>\n        ')}_data_vl_domainChangedCallback(e,t){this._domain=t,this._loadMessage()}_data_vl_codeChangedCallback(e,t){this._code=t,this._loadMessage()}_loadMessage(){this._domain&&this._code?this._getMessage(this._domain,this._code).then(e=>this._contentElement.innerHTML=e.tekst):this._contentElement.textContent=null}_getMessage(e,t){const n=this.__getMessageCacheForDomain(e);return n[t]||(n[t]=VlProzaMessage.__fetchMessage(e,t)),n[t]}static __fetchMessage(e,t){return fetch("proza/domein/"+e+"/"+t).then(e=>e.ok?e.json():new Promise((e,t)=>t("Fetching Proza message failed")))}get __domainCache(){var e=this.constructor.prototype;return e.__cache||(e.__cache={}),e.__cache}__getMessageCacheForDomain(e){return this.__domainCache[e]||(this.__domainCache[e]={}),this.__domainCache[e]}async __fetchToegelatenOperaties(){return fetch("proza/domein/"+this._domain+"/toegelatenoperaties").then(e=>e.json()).then(e=>e).catch(()=>{console.error("er is iets fout gelopen bij het ophalen van de toegelaten Proza operaties")})}async __processToegelatenOperaties(){(await this.__fetchToegelatenOperaties()).update&&this._element.appendChild(this._getEditButtonTemplate())}};define("vl-proza-message",VlProzaMessage);