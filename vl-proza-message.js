import{VlElement,define}from"/node_modules/vl-ui-core/vl-core.js";import"/node_modules/vl-ui-button/vl-button.js";import"/node_modules/vl-ui-icon/vl-icon.js";export class VlProzaMessage extends(VlElement(HTMLElement)){static get _observedAttributes(){return["data-vl-domain","data-vl-code"]}constructor(){super("\n            <style>\n                @import '/node_modules/vl-ui-button/style.css';\n                @import '/node_modules/vl-ui-icon/style.css';\n                \n                :host > div {\n                    display: inline;\n                }\n            </style>\n            <div>\n                <span id=\"content\"></span>\n            </div>\n        ")}connectedCallback(){this.__processToegelatenOperaties()}get _contentElement(){return this._element.querySelector("#content")}_getEditButtonTemplate(){return this._template('\n            <button is="vl-button-link" type="button">\n                <span is="vl-icon" icon="edit"></span>\n            </button>\n        ')}_data_vl_domainChangedCallback(e,t){this._domain=t,this._loadMessage()}_data_vl_codeChangedCallback(e,t){this._code=t,this._loadMessage()}_loadMessage(){this._domain&&this._code?VlProzaMessage._getMessage(this._domain,this._code).then(e=>this._contentElement.innerHTML=e.tekst):this._contentElement.innerHTML=null}static _getMessage(e,t){const a=VlProzaMessage.__getMessageCacheForDomain(e);return a[t]||(a[t]=VlProzaMessage.__fetchMessage(e,t)),a[t]}static _getToegelatenOperaties(e){let t=VlProzaMessage.__getToegelatenOperatiesCacheForDomain(e);return t||(t=VlProzaMessage.__fetchToegelatenOperaties(e),VlProzaMessage.__setToegelatenOperatiesCacheForDomain(e,t)),t}static __fetchMessage(e,t){return fetch("proza/domein/"+e+"/"+t).then(e=>{if(e.ok)return e.json();throw Error("Ophalen van Proza bericht is mislukt: "+e.statusText)}).catch(e=>(console.error("Er is iets fout gelopen bij het ophalen van de Proza berichten",e),Promise.reject(e)))}static __fetchToegelatenOperaties(e){return fetch("proza/domein/"+e+"/toegelatenoperaties").then(e=>{if(e.ok)return e.json();throw Error("Ophalen toegelaten Proza operaties is mislukt: "+e.statusText)}).catch(e=>(console.error("Er is iets fout gelopen bij het ophalen van de toegelaten Proza operaties",e),Promise.reject(e)))}static get __domainCache(){return VlProzaMessage.__cache||(VlProzaMessage.__cache={}),VlProzaMessage.__cache}static __getCacheForDomain(e){const t=VlProzaMessage.__domainCache;return t[e]||(t[e]={}),t[e]}static __getMessageCacheForDomain(e){const t=VlProzaMessage.__getCacheForDomain(e);return t.messages||(t.messages={}),t.messages}static __getToegelatenOperatiesCacheForDomain(e){return VlProzaMessage.__getCacheForDomain(e).toegelatenOperaties}static __setToegelatenOperatiesCacheForDomain(e,t){VlProzaMessage.__getCacheForDomain(e).toegelatenOperaties=t}async __processToegelatenOperaties(){(await VlProzaMessage._getToegelatenOperaties(this._domain)).update&&this._element.appendChild(this._getEditButtonTemplate())}};define("vl-proza-message",VlProzaMessage);